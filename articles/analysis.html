<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="transreg">
<title>Analysis • transreg</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analysis">
<meta property="og:description" content="transreg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">transreg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">functions</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/abstract.html">abstract</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/analysis.html">analysis</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">news</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Analysis</h1>
            
      
      
      <div class="d-none name"><code>analysis.Rmd</code></div>
    </div>

    
    
<p><strong>This file contains the code for reproducing the results shown
in the related manuscript (numbers, tables, figures). We obtained our
results on 2022-12-15 using R version 4.2.2 (2022-10-31) running
natively on a MacBook Pro (2020) with an Apple M1 chip, 16 GB memory,
and the operating system macOS Monterey (version 12.6). The total
computation time was around 7.5 hours.</strong></p>
<div class="section level2">
<h2 id="initialisation">Initialisation<a class="anchor" aria-label="anchor" href="#initialisation"></a>
</h2>
<p>Choose the directory containing the sub-directories “data”, “results”
and “manuscript”.</p>
<ul>
<li><p>The directory “data” may be empty for the first external
application (<em>script loads data - which are also available <a href="https://github.com/markvdwiel/GRridge/blob/master/data/dataVerlaat.rda" class="external-link">here</a>
- from the R package <a href="https://doi.org/10.18129/B9.bioc.GRridge" class="external-link"><code>GRridge</code></a></em>)
but must contain the file “pone.0181468.s001.csv” for the second
external application (<em>available from <a href="https://doi.org/10.1371/journal.pone.0181468" class="external-link">Erez et al. 2017</a>
in the supporting file <a href="https://doi.org/10.1371/journal.pone.0181468.s001" class="external-link">journal.pone.0181468.s001.csv</a></em>)
and the files “vcf_with_pvalue.tab” and “LuxPark_pheno.txt” for the
internal application (<em>available upon request to <a href="mailto:request.ncer-pd@uni.lu?cc=armin.rauschenberger@uni.lu,enrico.glaab@uni.lu&amp;subject=data%20request%20Rauschenberger%20et%20al.%20(%22transreg%22)">request.ncer-pd@uni.lu</a></em>).
For the internal application, this directory will also contain the
intermediate file “app_int_data.RData”.</p></li>
<li><p>The directory “results” will contain the files “sim_int.RData”
and “sim_ext.RData” for the external and internal simulation, the file
“app_grridge.RData” for the first external application, the file
“app_fwelnet.RData” for the second external application, and the file
“app_int.RData” for the internal application.</p></li>
<li><p>The directory “manuscript” will contain the files “table_int.tex”
and “table_ext.tex” for the internal and external simulations, the file
“figure_example.pdf” for the methods section, the file “figure_ext.pdf”
for the external applications, and the file “figure_int.pdf” for the
internal application.</p></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dir</span> <span class="op">&lt;-</span> <span class="st">"~/Desktop/transreg"</span> <span class="co"># physical machine</span></span>
<span><span class="co">#dir &lt;- "/home/armin.rauschenberger/transreg" # virtual machine</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="va">dir</span><span class="op">)</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"data"</span>,<span class="st">"results"</span>,<span class="st">"manuscript"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span> <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Missing folders!"</span><span class="op">)</span> </span>
<span><span class="op">}</span></span></code></pre></div>
<p>Install missing R packages from CRAN and GitHub. Note that
<code>ecpc</code> is and <code>transreg</code> will also be available on
CRAN. For package versions, see session information at the end of this
document and in the text files associated with each R data file.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># TO DO: UPDATE REFS AND VERSIONS!</span></span>
<span><span class="va">pkgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"devtools"</span>,<span class="st">"palasso"</span>,<span class="st">"glmtrans"</span>,<span class="st">"xtable"</span>,<span class="st">"ecpc"</span><span class="op">)</span></span>
<span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">pkgs</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html" class="external-link">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#remotes::install_github("markvdwiel/GRridge",dependencies=FALSE) # ref="ef706af", version 1.7.5</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"kjytay/fwelnet"</span><span class="op">)</span> <span class="co"># ref="5515fd2", version 0.1</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"LCSB-BDS/transreg"</span><span class="op">)</span> <span class="co"># ref="ca70d0c", version 0.99.2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">pkgs</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a>
</h2>
<p>The following chunk generates the figure for the methods section.</p>
<ul>
<li><p>input: none (<em>simulating data</em>)</p></li>
<li><p>execution time: some seconds</p></li>
<li><p>output: manuscript/figure_example.pdf</p></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#&lt;&lt;init&gt;&gt;</span></span>
<span><span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html" class="external-link">pdf</a></span><span class="op">(</span>file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/manuscript/figure_example.pdf"</span><span class="op">)</span>,width<span class="op">=</span><span class="fl">8</span>,height<span class="op">=</span><span class="fl">5</span>,pointsize<span class="op">=</span><span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span>; <span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span><span class="op">)</span>,nrow<span class="op">=</span><span class="va">n</span>,ncol<span class="op">=</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="va">range</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span>p<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>,<span class="fl">0.99</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">temp</span><span class="op">[</span><span class="va">temp</span><span class="op">&lt;</span><span class="va">range</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">range</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">temp</span><span class="op">[</span><span class="va">temp</span><span class="op">&gt;</span><span class="va">range</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">range</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span></span>
<span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">beta</span><span class="op">$</span><span class="va">ident</span> <span class="op">&lt;-</span> <span class="va">temp</span></span>
<span><span class="va">beta</span><span class="op">$</span><span class="va">sqrt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">beta</span><span class="op">$</span><span class="va">quad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="va">beta</span><span class="op">$</span><span class="va">trunc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">temp</span><span class="op">&lt;=</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="va">temp</span><span class="op">)</span></span>
<span><span class="va">beta</span><span class="op">$</span><span class="va">step</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">temp</span><span class="op">&lt;=</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">beta</span><span class="op">$</span><span class="va">combn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">temp</span><span class="op">&lt;</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">temp</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">eta</span> <span class="op">&lt;-</span> <span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">beta</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="va">n</span>,mean<span class="op">=</span><span class="va">eta</span>,sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">eta</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu">transreg</span><span class="fu">:::</span><span class="fu"><a href="../reference/calibrate.html">.exp.multiple</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">y</span>,X<span class="op">=</span><span class="va">X</span>,prior<span class="op">=</span><span class="va">prior</span>,family<span class="op">=</span><span class="st">"gaussian"</span>,select<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">transreg</span><span class="fu">:::</span><span class="fu"><a href="../reference/calibrate.html">.iso.fast.single</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">y</span>,X<span class="op">=</span><span class="va">X</span>,prior<span class="op">=</span><span class="va">prior</span>,family<span class="op">=</span><span class="st">"gaussian"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/frame.html" class="external-link">plot.new</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html" class="external-link">plot.window</a></span><span class="op">(</span>xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">prior</span>,<span class="op">-</span><span class="va">prior</span><span class="op">)</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">a</span><span class="op">$</span><span class="va">beta</span>,<span class="va">b</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span>side<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span>side<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span>,lty<span class="op">=</span><span class="fl">2</span>,col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fl">0</span>,lty<span class="op">=</span><span class="fl">2</span>,col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span>xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>,ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">gamma</span><span class="op">)</span>,line<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">prior</span>,y<span class="op">=</span><span class="va">a</span><span class="op">$</span><span class="va">beta</span>,col<span class="op">=</span><span class="st">"red"</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">prior</span>,y<span class="op">=</span><span class="va">b</span><span class="op">$</span><span class="va">beta</span>,col<span class="op">=</span><span class="st">"blue"</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">prior</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">prior</span><span class="op">)</span><span class="op">]</span>,y<span class="op">=</span><span class="va">beta</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">prior</span><span class="op">)</span><span class="op">]</span>,lwd<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"topleft"</span>,legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"("</span>,<span class="va">i</span>,<span class="st">")"</span><span class="op">)</span>,bty<span class="op">=</span><span class="st">"n"</span>,x.intersp<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simulations">Simulations<a class="anchor" aria-label="anchor" href="#simulations"></a>
</h2>
<p>The following chunk performs the external (<code>glmtrans</code>) and
the internal simulation.</p>
<ul>
<li><p>input: none (<em>simulating data</em>)</p></li>
<li><p>execution time: <strong>25 minutes</strong> (MUCH LONGER IF 10
SEEDS AND P=2000!)</p></li>
<li><p>output: results/sim_ext.RData, results/sim_int.RData,
results/info_sim.RData</p></li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#&lt;&lt;init&gt;&gt;</span></span>
<span></span>
<span><span class="co"># - - - modify glmtrans::models function - - -</span></span>
<span><span class="va">glmtrans.models</span> <span class="op">&lt;-</span> <span class="fu">glmtrans</span><span class="fu">::</span><span class="va">models</span></span>
<span><span class="va">string</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/deparse.html" class="external-link">deparse</a></span><span class="op">(</span><span class="va">glmtrans.models</span><span class="op">)</span></span>
<span><span class="co"># return target beta</span></span>
<span><span class="va">string</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span>pattern<span class="op">=</span><span class="st">"list\\(x \\= NULL, y \\= NULL\\)"</span>,</span>
<span>               replacement<span class="op">=</span><span class="st">"list(x = NULL, y = NULL, beta = wk)"</span>,</span>
<span>               x<span class="op">=</span><span class="va">string</span><span class="op">)</span></span>
<span><span class="co"># return source beta</span></span>
<span><span class="va">string</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span>pattern<span class="op">=</span><span class="st">"list\\(x \\= x, y \\= y\\)"</span>,</span>
<span>               replacement<span class="op">=</span><span class="st">"list(x = x, y = y, beta = wk)"</span>,</span>
<span>               x<span class="op">=</span><span class="va">string</span><span class="op">)</span></span>
<span><span class="va">glmtrans.models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eval.html" class="external-link">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/parse.html" class="external-link">parse</a></span><span class="op">(</span>text<span class="op">=</span><span class="va">string</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">string</span><span class="op">)</span></span>
<span><span class="co"># - - - - - - - - - - - - - - - - - - - - - -</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">mode</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ext"</span>,<span class="st">"int"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>    <span class="co"># simulation setting</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">mode</span><span class="op">==</span><span class="st">"ext"</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>seed<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="co"># trial (added line)</span></span>
<span>                           Ka<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                           K<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>                           h<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">250</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                           alpha<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                           family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gaussian"</span>,<span class="st">"binomial"</span><span class="op">)</span></span>
<span>                           <span class="op">)</span></span>
<span>      <span class="co">#frame$seed &lt;- rep(1:4,each=6) # original</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">mode</span><span class="op">==</span><span class="st">"int"</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>seed<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="co"># trial (added line)</span></span>
<span>                           rho.x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>,<span class="fl">0.99</span><span class="op">)</span>,</span>
<span>                           rho.beta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.70</span>,<span class="fl">0.85</span>,<span class="fl">0.99</span><span class="op">)</span>,</span>
<span>                           alpha<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                           family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gaussian"</span>,<span class="st">"binomial"</span><span class="op">)</span></span>
<span>                           <span class="op">)</span></span>
<span>      <span class="co">#frame$seed &lt;- 1:24 # original</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">frame</span><span class="op">$</span><span class="va">family</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">frame</span><span class="op">$</span><span class="va">family</span><span class="op">)</span></span>
<span>    <span class="va">frame</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cor.x"</span>,<span class="st">"cor.beta"</span>,<span class="st">"mean"</span>,<span class="st">"glmnet"</span>,<span class="st">"glmtrans"</span>,<span class="st">"transreg"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>    <span class="co">#p &lt;- 1000; # original</span></span>
<span>    <span class="va">n0</span> <span class="op">&lt;-</span> <span class="fl">100</span>; <span class="va">n1</span> <span class="op">&lt;-</span> <span class="fl">10000</span></span>
<span>    <span class="va">n.target</span> <span class="op">&lt;-</span> <span class="va">n0</span><span class="op">+</span><span class="va">n1</span></span>
<span>    <span class="va">foldid.ext</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">n0</span>,<span class="va">n1</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="kw">for</span><span class="op">(</span><span class="va">iter</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">frame</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">mode</span>,<span class="st">": "</span>,<span class="va">iter</span>,<span class="st">"/"</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">frame</span><span class="op">)</span>,<span class="st">"\n"</span><span class="op">)</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">frame</span><span class="op">$</span><span class="va">seed</span><span class="op">[</span><span class="va">iter</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">frame</span><span class="op">$</span><span class="va">seed</span><span class="op">[</span><span class="va">iter</span><span class="op">]</span><span class="op">)</span><span class="op">}</span></span>
<span>      <span class="co">#alpha &lt;- frame$alpha[iter] </span></span>
<span>      <span class="co">#family &lt;- as.character(frame$family[iter])</span></span>
<span>      <span class="co">#rho.beta &lt;- frame$rho.beta[iter]</span></span>
<span>      </span>
<span>      <span class="co"># data simulation</span></span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="va">mode</span><span class="op">==</span><span class="st">"ext"</span><span class="op">)</span><span class="op">{</span> </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Using external simulation study!"</span><span class="op">)</span></span>
<span>        <span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">frame</span><span class="op">$</span><span class="va">alpha</span><span class="op">[</span><span class="va">iter</span><span class="op">]</span><span class="op">==</span><span class="fl">0</span>,<span class="fl">50</span>,<span class="fl">15</span><span class="op">)</span></span>
<span>        <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">glmtrans.models</span><span class="op">(</span>family<span class="op">=</span><span class="va">frame</span><span class="op">$</span><span class="va">family</span><span class="op">[</span><span class="va">iter</span><span class="op">]</span>,type<span class="op">=</span><span class="st">"all"</span>,</span>
<span>                                p<span class="op">=</span><span class="fl">1000</span>,n.target<span class="op">=</span><span class="va">n.target</span>,s<span class="op">=</span><span class="va">s</span>,</span>
<span>                                Ka<span class="op">=</span><span class="va">frame</span><span class="op">$</span><span class="va">Ka</span><span class="op">[</span><span class="va">iter</span><span class="op">]</span>,K<span class="op">=</span><span class="va">frame</span><span class="op">$</span><span class="va">K</span><span class="op">[</span><span class="va">iter</span><span class="op">]</span>,h<span class="op">=</span><span class="va">frame</span><span class="op">$</span><span class="va">h</span><span class="op">[</span><span class="va">iter</span><span class="op">]</span><span class="op">)</span> <span class="co"># original: p=p</span></span>
<span>        <span class="va">target</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">target</span></span>
<span>        <span class="va">source</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">source</span></span>
<span>        <span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">source</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span>,<span class="va">data</span><span class="op">$</span><span class="va">target</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span></span>
<span>      <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">mode</span><span class="op">==</span><span class="st">"int"</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Using internal simulation study!"</span><span class="op">)</span></span>
<span>        <span class="va">prop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">frame</span><span class="op">$</span><span class="va">alpha</span><span class="op">[</span><span class="va">iter</span><span class="op">]</span><span class="op">==</span><span class="fl">0</span>,<span class="fl">0.2</span>,<span class="fl">0.05</span><span class="op">)</span></span>
<span>        <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">transreg</span><span class="fu">:::</span><span class="fu"><a href="../reference/simulate.html">simulate</a></span><span class="op">(</span>p<span class="op">=</span><span class="fl">2000</span>,n.target<span class="op">=</span><span class="va">n.target</span>,family<span class="op">=</span><span class="va">frame</span><span class="op">$</span><span class="va">family</span><span class="op">[</span><span class="va">iter</span><span class="op">]</span>,</span>
<span>                                prop<span class="op">=</span><span class="va">prop</span>,rho.beta<span class="op">=</span><span class="va">frame</span><span class="op">$</span><span class="va">rho.beta</span><span class="op">[</span><span class="va">iter</span><span class="op">]</span>,w<span class="op">=</span><span class="fl">0.5</span>,</span>
<span>                                rho.x<span class="op">=</span><span class="va">frame</span><span class="op">$</span><span class="va">rho.x</span><span class="op">[</span><span class="va">iter</span><span class="op">]</span>,k<span class="op">=</span><span class="fl">3</span>,exp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                                trans<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>,<span class="cn">TRUE</span>,<span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="co"># original: p=p</span></span>
<span>        <span class="va">target</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">target</span></span>
<span>        <span class="va">source</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">source</span></span>
<span>        <span class="va">beta</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">beta</span></span>
<span>      <span class="op">}</span></span>
<span>      </span>
<span>      <span class="co"># correlation</span></span>
<span>      <span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">target</span><span class="op">$</span><span class="va">x</span>,method<span class="op">=</span><span class="st">"pearson"</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="va">temp</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="va">temp</span>,diag<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>      <span class="va">frame</span><span class="op">$</span><span class="va">cor.x</span><span class="op">[</span><span class="va">iter</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">temp</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>      <span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">beta</span>,method<span class="op">=</span><span class="st">"pearson"</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="va">temp</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="va">temp</span>,diag<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>      <span class="va">frame</span><span class="op">$</span><span class="va">cor.beta</span><span class="op">[</span><span class="va">iter</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">temp</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span><span class="op">]</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="co"># predictive performance</span></span>
<span>      <span class="va">loss</span> <span class="op">&lt;-</span> <span class="fu">transreg</span><span class="fu">:::</span><span class="fu"><a href="../reference/compare.html">compare</a></span><span class="op">(</span>target<span class="op">=</span><span class="va">target</span>,source<span class="op">=</span><span class="va">source</span>,</span>
<span>                          family<span class="op">=</span><span class="va">frame</span><span class="op">$</span><span class="va">family</span><span class="op">[</span><span class="va">iter</span><span class="op">]</span>,alpha<span class="op">=</span><span class="va">frame</span><span class="op">$</span><span class="va">alpha</span><span class="op">[</span><span class="va">iter</span><span class="op">]</span>,</span>
<span>                          foldid.ext<span class="op">=</span><span class="va">foldid.ext</span>,nfolds.ext<span class="op">=</span><span class="fl">1</span>,</span>
<span>                          scale<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exp"</span>,<span class="st">"iso"</span><span class="op">)</span>,</span>
<span>                          sign<span class="op">=</span><span class="cn">FALSE</span>,switch<span class="op">=</span><span class="cn">FALSE</span>,select<span class="op">=</span><span class="cn">TRUE</span>,alpha.prior<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>                          seed<span class="op">=</span><span class="va">frame</span><span class="op">$</span><span class="va">seed</span><span class="op">[</span><span class="va">iter</span><span class="op">]</span><span class="op">)</span></span>
<span>      <span class="va">frame</span><span class="op">[</span><span class="va">iter</span>,<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">loss</span><span class="op">$</span><span class="va">deviance</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">loss</span><span class="op">$</span><span class="va">deviance</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">frame</span>,file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/results/sim_"</span>,<span class="va">mode</span>,<span class="st">"_trial.RData"</span><span class="op">)</span><span class="op">)</span> <span class="co"># TO DO: remove "_trial"!</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span>text<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/utils/capture.output.html" class="external-link">capture.output</a></span><span class="op">(</span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n"</span><span class="op">)</span>,</span>
<span>      <span class="fu">sessioninfo</span><span class="fu">::</span><span class="fu"><a href="https://r-lib.github.io/sessioninfo/reference/session_info.html" class="external-link">session_info</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,con<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/results/info_sim.txt"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The following chunk generates the tables for the external
(<code>glmtrans</code>) and the internal simulation. <strong>Requires
execution of previous chunk.</strong></p>
<ul>
<li><p>input: results/sim_ext.RData, results/sim_int.RData</p></li>
<li><p>execution time: some seconds</p></li>
<li><p>output: manuscript/table_ext.tex,
manuscript/table_int.tex</p></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">.table</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">loss</span>,<span class="va">info</span><span class="op">=</span><span class="cn">NULL</span>,<span class="va">hline</span><span class="op">=</span><span class="cn">NULL</span>,<span class="va">pvalue</span><span class="op">=</span><span class="cn">NULL</span>,<span class="va">caption</span><span class="op">=</span><span class="st">""</span>,<span class="va">file</span><span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">loss</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">Inf</span></span>
<span>  </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">5</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">quote</span> <span class="op">&lt;-</span> <span class="cn">NA</span><span class="op">*</span><span class="va">loss</span></span>
<span>  <span class="va">quote</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span>  <span class="va">quote</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="va">loss</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">==</span><span class="va">loss</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span> <span class="op">&amp;</span> <span class="va">loss</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">==</span><span class="va">loss</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span> <span class="op">&amp;</span> <span class="va">loss</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">==</span><span class="va">loss</span><span class="op">[</span><span class="fl">4</span>,<span class="op">]</span></span>
<span>  <span class="va">quote</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="va">loss</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span><span class="op">==</span><span class="va">loss</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span> <span class="op">&amp;</span> <span class="va">loss</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span><span class="op">==</span><span class="va">loss</span><span class="op">[</span><span class="fl">4</span>,<span class="op">]</span> <span class="op">&amp;</span> <span class="va">loss</span><span class="op">[</span><span class="fl">4</span>,<span class="op">]</span><span class="op">==</span><span class="va">loss</span><span class="op">[</span><span class="fl">5</span>,<span class="op">]</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">4</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">quote</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">loss</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span><span class="op">==</span><span class="va">loss</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span>,<span class="op">]</span> <span class="op">&amp;</span> <span class="va">loss</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span><span class="op">==</span><span class="va">loss</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">2</span>,<span class="op">]</span> <span class="op">&amp;</span> <span class="va">loss</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span><span class="op">==</span><span class="va">loss</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">3</span>,<span class="op">]</span><span class="op">)</span> <span class="op">|</span> </span>
<span>      <span class="op">(</span><span class="va">loss</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span><span class="op">==</span><span class="va">loss</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span>,<span class="op">]</span> <span class="op">&amp;</span> <span class="va">loss</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span><span class="op">==</span><span class="va">loss</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span>,<span class="op">]</span> <span class="op">&amp;</span> <span class="va">loss</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span><span class="op">==</span><span class="va">loss</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">2</span>,<span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">quote</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">quote</span><span class="op">)</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="va">loss</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">quote</span><span class="op">)</span>,<span class="op">]</span><span class="op">==</span><span class="va">loss</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">quote</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span>,<span class="op">]</span> <span class="op">&amp;</span></span>
<span>          <span class="va">loss</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">quote</span><span class="op">)</span>,<span class="op">]</span><span class="op">==</span><span class="va">loss</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">quote</span><span class="op">)</span><span class="op">-</span><span class="fl">2</span>,<span class="op">]</span> <span class="op">&amp;</span></span>
<span>          <span class="va">loss</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">quote</span><span class="op">)</span>,<span class="op">]</span><span class="op">==</span><span class="va">loss</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">quote</span><span class="op">)</span><span class="op">-</span><span class="fl">3</span>,<span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">loss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">loss</span>,digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span>   </span>
<span>  <span class="va">min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">loss</span>,<span class="fl">1</span>,<span class="va">which.min</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">pos</span> <span class="op">&lt;-</span> <span class="va">loss</span> <span class="op">&gt;=</span> <span class="fl">0</span></span>
<span>  <span class="va">leq</span> <span class="op">&lt;-</span> <span class="va">loss</span> <span class="op">&gt;=</span> <span class="va">loss</span><span class="op">[</span>,<span class="st">"glmnet"</span><span class="op">]</span></span>
<span>  <span class="va">loss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">loss</span>,digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span>,digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">5</span><span class="op">)</span><span class="op">{</span><span class="va">loss</span><span class="op">[</span><span class="va">quote</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"\""</span><span class="op">}</span></span>
<span>  <span class="va">loss</span><span class="op">[</span><span class="va">leq</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"\\textcolor{gray}{"</span>,<span class="va">loss</span><span class="op">[</span><span class="va">leq</span><span class="op">]</span>,<span class="st">"}"</span><span class="op">)</span></span>
<span>  <span class="va">loss</span><span class="op">[</span><span class="va">min</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"\\underline{"</span>,<span class="va">loss</span><span class="op">[</span><span class="va">min</span><span class="op">]</span>,<span class="st">"}"</span><span class="op">)</span></span>
<span>  <span class="va">loss</span><span class="op">[</span><span class="va">pos</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"~"</span>,<span class="va">loss</span><span class="op">[</span><span class="va">pos</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"\\texttt{"</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span>,<span class="st">"}"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"\\textsc{"</span>,<span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span><span class="op">)</span>,<span class="st">"}"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">info</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">table</span> <span class="op">&lt;-</span> <span class="va">loss</span></span>
<span>    <span class="va">align</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"|r|"</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"r"</span>,times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span><span class="op">)</span>,collapse<span class="op">=</span><span class="st">""</span><span class="op">)</span>,<span class="st">"|"</span><span class="op">)</span></span>
<span>    <span class="va">include.rownames</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">info</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">info</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"-"</span></span>
<span>    <span class="va">table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">info</span>,<span class="va">loss</span><span class="op">)</span></span>
<span>    <span class="va">align</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"|r|"</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"r"</span>,times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">info</span><span class="op">)</span><span class="op">)</span>,collapse<span class="op">=</span><span class="st">""</span><span class="op">)</span>,<span class="st">"|"</span>,</span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"r"</span>,times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span><span class="op">)</span>,collapse<span class="op">=</span><span class="st">""</span><span class="op">)</span>,<span class="st">"|"</span><span class="op">)</span></span>
<span>    <span class="va">include.rownames</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">xtable</span> <span class="op">&lt;-</span> <span class="fu">xtable</span><span class="fu">::</span><span class="fu">xtable</span><span class="op">(</span>x<span class="op">=</span><span class="va">table</span>,caption<span class="op">=</span><span class="va">caption</span>,align<span class="op">=</span><span class="va">align</span><span class="op">)</span></span>
<span>  <span class="fu">xtable</span><span class="fu">::</span><span class="fu">print.xtable</span><span class="op">(</span>x<span class="op">=</span><span class="va">xtable</span>,</span>
<span>                       sanitize.text.function<span class="op">=</span><span class="va">identity</span>,</span>
<span>                       include.rownames<span class="op">=</span><span class="va">include.rownames</span>,</span>
<span>                       floating<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                       comment<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                       hline.after<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="va">hline</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">table</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                       caption.placement<span class="op">=</span><span class="st">"top"</span>,</span>
<span>                       file<span class="op">=</span><span class="va">file</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">mode</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ext"</span>,<span class="st">"int"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/results/sim_"</span>,<span class="va">mode</span>,<span class="st">".RData"</span><span class="op">)</span> <span class="co"># original</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="kw"><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></span><span class="op">(</span><span class="st">"Missing file "</span>,<span class="va">file</span>,<span class="st">"."</span><span class="op">)</span>;<span class="kw">next</span><span class="op">}</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span></span>
<span>    <span class="va">cond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">frame</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ka"</span>,<span class="st">"h"</span>,<span class="st">"rho.x"</span>,<span class="st">"rho.beta"</span>,<span class="st">"cor.x"</span>,<span class="st">"cor.beta"</span>,<span class="st">"cor.t"</span>,<span class="st">"alpha"</span>,<span class="st">"family"</span><span class="op">)</span></span>
<span>    <span class="va">info</span> <span class="op">&lt;-</span> <span class="va">frame</span><span class="op">[</span>,<span class="va">cond</span><span class="op">]</span></span>
<span>    <span class="va">info</span> <span class="op">&lt;-</span> <span class="va">info</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">info</span><span class="op">)</span><span class="op">)</span><span class="op">&lt;</span><span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span>pattern<span class="op">=</span><span class="st">"transreg."</span>,replacement<span class="op">=</span><span class="st">""</span>,x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">frame</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="co">#colnames(frame) &lt;- gsub(pattern="_",replacement=".",x=colnames(frame))</span></span>
<span>    <span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>,<span class="st">"glmnet"</span>,<span class="st">"glmtrans"</span>,<span class="st">"exp.sta"</span>,<span class="st">"exp.sim"</span>,<span class="st">"iso.sta"</span>,<span class="st">"iso.sim"</span><span class="op">)</span></span>
<span>    <span class="va">loss</span> <span class="op">&lt;-</span> <span class="va">frame</span><span class="op">[</span>,<span class="va">names</span><span class="op">]</span></span>
<span>    <span class="va">loss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="va">loss</span><span class="op">/</span><span class="va">loss</span><span class="op">$</span><span class="va">mean</span>,digits<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">loss</span> <span class="op">&lt;-</span> <span class="va">loss</span><span class="op">[</span>,<span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"mean"</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">info</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">info</span><span class="op">)</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="va">x</span>,<span class="st">"Ka"</span><span class="op">=</span><span class="st">"$K_a$"</span>,<span class="st">"K"</span><span class="op">=</span><span class="st">"$K$"</span>,<span class="st">"h"</span><span class="op">=</span><span class="st">"$h$"</span>,<span class="st">"alpha"</span><span class="op">=</span><span class="st">"$\\alpha$"</span>,<span class="st">"rho.x"</span><span class="op">=</span><span class="st">"$\\rho_x$"</span>,<span class="st">"rho.beta"</span><span class="op">=</span><span class="st">"$\\rho_\\beta$"</span>,<span class="st">"cor.x"</span><span class="op">=</span><span class="st">"$\\bar{\\rho}_{x}$"</span>,<span class="st">"cor.beta"</span><span class="op">=</span><span class="st">"$\\max(\\hat{\\rho}_{\\beta})$"</span>,<span class="st">"cor.t"</span><span class="op">=</span><span class="st">"$\\bar{\\rho}_{a}$"</span>,<span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">external</span> <span class="op">&lt;-</span> <span class="st">"number of transferable source data sets ($K_a$), differences between source and target coefficients ($h$), dense setting with ridge regularisation ($s=50$, $\\alpha=0$) or sparse setting with lasso regularisation ($s=15$, $\\alpha=1$), family of distribution (`gaussian' or `binomial')."</span></span>
<span>    <span class="va">internal</span> <span class="op">&lt;-</span> <span class="st">"correlation parameter for features ($\\rho_x$), correlation parameter for coefficients ($\\rho_{\\beta}$), dense setting with ridge regularisation ($\\pi=20\\%$, $\\alpha=0$) or sparse setting with lasso regularisation ($\\pi=5\\%$, $\\alpha=1$), family of distribution (`gaussian' or `binomial')."</span></span>
<span>    <span class="va">caption</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Testing loss in "</span>,<span class="va">mode</span>,<span class="st">"ernal simulation, as a percentage of the one from prediction by the mean. Settings: "</span>,<span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">mode</span><span class="op">==</span><span class="st">"ext"</span>,<span class="va">external</span>,<span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">mode</span><span class="op">==</span><span class="st">"int"</span>,<span class="va">internal</span>,<span class="cn">NULL</span><span class="op">)</span><span class="op">)</span>,<span class="st">" These parameters determine (i) the average Pearson correlations among the features in the target data set ($\\bar{\\rho}_x$) and (ii) the maximum Pearson correlation between the coefficients in the target data set and the coefficients in the source data sets ($\\max(\\hat{\\rho}_{\\beta})$). Methods: regularised regression (\\texttt{glmnet}), competing transfer learning method (\\texttt{glmtrans}), proposed transfer learning method (\\texttt{transreg}) with exponential/isotonic calibration and standard/simultaneous stacking. In each setting, the colour black highlights methods that are more predictive than regularised regression without transfer learning (\\texttt{glmnet}), and an underline highlights the most predictive method. \\label{sim_"</span>,<span class="va">mode</span>,<span class="st">"}"</span><span class="op">)</span></span>
<span>    <span class="fu">.table</span><span class="op">(</span>info<span class="op">=</span><span class="va">info</span>,loss<span class="op">=</span><span class="va">loss</span>,caption<span class="op">=</span><span class="va">caption</span>,file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/manuscript/table_"</span>,<span class="va">mode</span>,<span class="st">".tex"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dir</span> <span class="op">&lt;-</span> <span class="st">"~/Desktop/transreg"</span> <span class="co"># physical machine</span></span>
<span><span class="co">#dir &lt;- "/home/armin.rauschenberger/transreg" # virtual machine</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="va">dir</span><span class="op">)</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"data"</span>,<span class="st">"results"</span>,<span class="st">"manuscript"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span> <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Missing folders!"</span><span class="op">)</span> </span>
<span><span class="op">}</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">mode</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ext"</span>,<span class="st">"int"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/results/sim_"</span>,<span class="va">mode</span>,<span class="st">"_trial.RData"</span><span class="op">)</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="kw"><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></span><span class="op">(</span><span class="st">"Missing file "</span>,<span class="va">file</span>,<span class="st">"."</span><span class="op">)</span>;<span class="kw">next</span><span class="op">}</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span>pattern<span class="op">=</span><span class="st">"transreg."</span>,replacement<span class="op">=</span><span class="st">""</span>,x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">frame</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">info.var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ka"</span>,<span class="st">"h"</span>,<span class="st">"rho.x"</span>,<span class="st">"rho.beta"</span>,<span class="st">"alpha"</span>,<span class="st">"family"</span><span class="op">)</span></span>
<span>    <span class="va">info</span> <span class="op">&lt;-</span> <span class="va">frame</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">frame</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">info.var</span><span class="op">]</span></span>
<span>    <span class="va">info.name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span>pattern<span class="op">=</span><span class="st">" "</span>,replacement<span class="op">=</span><span class="st">""</span>,x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">info</span>,<span class="fl">1</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">x</span>,collapse<span class="op">=</span><span class="st">"."</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">number</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">info.name</span>,levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">info.name</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">info</span><span class="op">)</span></span>
<span>    <span class="va">info</span><span class="op">$</span><span class="va">cor.beta</span> <span class="op">&lt;-</span> <span class="va">info</span><span class="op">$</span><span class="va">cor.x</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>    </span>
<span>    <span class="va">loss.var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"glmnet"</span>,<span class="st">"glmtrans"</span>,<span class="st">"exp.sta"</span>,<span class="st">"exp.sim"</span>,<span class="st">"iso.sta"</span>,<span class="st">"iso.sim"</span><span class="op">)</span></span>
<span>    <span class="va">loss</span> <span class="op">&lt;-</span> <span class="va">frame</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">loss.var</span>,<span class="st">"mean"</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="co"># as percentage of empty model</span></span>
<span>    <span class="va">loss</span> <span class="op">&lt;-</span> <span class="fl">100</span><span class="op">*</span><span class="va">loss</span><span class="op">/</span><span class="va">loss</span><span class="op">$</span><span class="va">mean</span></span>
<span>  </span>
<span>    <span class="co"># average over 10 different seeds</span></span>
<span>    <span class="va">both</span> <span class="op">&lt;-</span> <span class="va">mean</span> <span class="op">&lt;-</span> <span class="va">sd</span> <span class="op">&lt;-</span> <span class="va">p.better</span> <span class="op">&lt;-</span> <span class="va">p.worse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>,nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">number</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">loss.var</span><span class="op">)</span>,dimnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">number</span><span class="op">)</span>,<span class="va">loss.var</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">number</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">loss.var</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">cond</span> <span class="op">&lt;-</span> <span class="va">number</span><span class="op">==</span><span class="va">i</span></span>
<span>        <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">loss</span><span class="op">$</span><span class="va">glmnet</span><span class="op">[</span><span class="va">cond</span><span class="op">]</span></span>
<span>        <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">loss</span><span class="op">[[</span><span class="va">loss.var</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">cond</span><span class="op">]</span></span>
<span>        <span class="va">p.better</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>,y<span class="op">=</span><span class="va">y</span>,paired<span class="op">=</span><span class="cn">TRUE</span>,alternative<span class="op">=</span><span class="st">"greater"</span>,exact<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span>
<span>        <span class="va">p.worse</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>,y<span class="op">=</span><span class="va">y</span>,paired<span class="op">=</span><span class="cn">TRUE</span>,alternative<span class="op">=</span><span class="st">"less"</span>,exact<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span>
<span>        <span class="va">mean</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span>        <span class="va">sd</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span>        <span class="va">info</span><span class="op">$</span><span class="va">cor.x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">frame</span><span class="op">$</span><span class="va">cor.x</span><span class="op">[</span><span class="va">cond</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="va">info</span><span class="op">$</span><span class="va">cor.beta</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">frame</span><span class="op">$</span><span class="va">cor.beta</span><span class="op">[</span><span class="va">cond</span><span class="op">]</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="va">front</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">mean</span>,digits<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,trim<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="va">front.nchar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">front</span><span class="op">)</span></span>
<span>    <span class="va">back</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">sd</span>,digits<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,trim<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="va">back.nchar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">back</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">both</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">front</span>,<span class="st">"$\\pm$"</span>,<span class="va">back</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">grey</span> <span class="op">&lt;-</span> <span class="va">mean</span><span class="op">&gt;=</span><span class="va">mean</span><span class="op">[</span>,<span class="st">"glmnet"</span><span class="op">]</span></span>
<span>    <span class="va">both</span><span class="op">[</span><span class="va">grey</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"\\textcolor{gray}{"</span>,<span class="va">both</span><span class="op">[</span><span class="va">grey</span><span class="op">]</span>,<span class="st">"}"</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">number</span><span class="op">)</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">mean</span>,<span class="fl">1</span>,<span class="va">which.min</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">both</span><span class="op">[</span><span class="va">min</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"\\underline{"</span>,<span class="va">both</span><span class="op">[</span><span class="va">min</span><span class="op">]</span>,<span class="st">"}"</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">star</span> <span class="op">&lt;-</span> <span class="va">p.better</span><span class="op">&lt;=</span><span class="fl">0.05</span></span>
<span>    <span class="va">both</span><span class="op">[</span><span class="va">star</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">both</span><span class="op">[</span><span class="va">star</span><span class="op">]</span>,<span class="st">"*"</span><span class="op">)</span></span>
<span>    <span class="co">#both[!star] &lt;- paste0(both[!star],"\\phantom{*}") </span></span>
<span>    </span>
<span>    <span class="va">dagger</span> <span class="op">&lt;-</span> <span class="va">p.worse</span><span class="op">&lt;=</span><span class="fl">0.05</span></span>
<span>    <span class="va">both</span><span class="op">[</span><span class="va">dagger</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">both</span><span class="op">[</span><span class="va">dagger</span><span class="op">]</span>,<span class="st">"$\\dagger$"</span><span class="op">)</span></span>
<span>    <span class="va">both</span><span class="op">[</span><span class="op">!</span><span class="va">star</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">dagger</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">both</span><span class="op">[</span><span class="op">!</span><span class="va">star</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">dagger</span><span class="op">]</span>,<span class="st">"\\phantom{*}"</span><span class="op">)</span> </span>
<span>    </span>
<span>    <span class="va">both</span><span class="op">[</span><span class="va">front.nchar</span><span class="op">==</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"$~$"</span>,<span class="va">both</span><span class="op">[</span><span class="va">front.nchar</span><span class="op">==</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">both</span><span class="op">[</span><span class="va">back.nchar</span><span class="op">==</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">both</span><span class="op">[</span><span class="va">back.nchar</span><span class="op">==</span><span class="fl">3</span><span class="op">]</span>,<span class="st">"$~$"</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">external</span> <span class="op">&lt;-</span> <span class="st">"number of transferable source data sets ($K_a$), differences between source and target coefficients ($h$), dense setting with ridge regularisation ($s=50$, $\\alpha=0$) or sparse setting with lasso regularisation ($s=15$, $\\alpha=1$), family of distribution (`gaussian' or `binomial')."</span></span>
<span>    <span class="va">internal</span> <span class="op">&lt;-</span> <span class="st">"correlation parameter for features ($\\rho_x$), correlation parameter for coefficients ($\\rho_{\\beta}$), dense setting with ridge regularisation ($\\pi=20\\%$, $\\alpha=0$) or sparse setting with lasso regularisation ($\\pi=5\\%$, $\\alpha=1$), family of distribution (`gaussian' or `binomial')."</span></span>
<span>    <span class="va">caption</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"\\textcolor{blue}{\\sout{Testing loss in "</span>,<span class="va">mode</span>,<span class="st">"ernal simulation, as a percentage of the one from prediction by the mean.} Predictive performance in "</span>,<span class="va">mode</span>,<span class="st">"ernal simulation. In each setting (row), we simulate $10$ data sets, calculate the performance metric (mean-squared error for numerical prediction, logistic deviance for binary classification) for the test sets, express these metrics as percentages of those from prediction by the mean, and show the mean and standard deviation of these percentages.} Settings: "</span>,<span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">mode</span><span class="op">==</span><span class="st">"ext"</span>,<span class="va">external</span>,<span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">mode</span><span class="op">==</span><span class="st">"int"</span>,<span class="va">internal</span>,<span class="cn">NULL</span><span class="op">)</span><span class="op">)</span>,<span class="st">" These parameters determine (i) the \\textcolor{blue}{\\sout{average} mean} Pearson correlation\\textcolor{blue}{\\sout{s}} among the features in the target data set ($\\bar{\\rho}_x$) and (ii) the maximum Pearson correlation between the coefficients in the target data set and the coefficients in the source data sets ($\\max(\\hat{\\rho}_{\\beta})$). Methods: regularised regression (\\texttt{glmnet}), competing transfer learning method (\\texttt{glmtrans}), proposed transfer learning method (\\texttt{transreg}) with exponential/isotonic calibration and standard/simultaneous stacking. In each setting, the colour black \\textcolor{blue}{(grey)} highlights methods that are more \\textcolor{blue}{(less)} predictive than regularised regression without transfer learning (\\texttt{glmnet}), \\textcolor{blue}{asterisks (daggers) indicate methods that are \\textit{significantly} more (less) predictive at the 5\\% level (one-sided Wilcoxon signed-rank test),} and an underline highlights the most predictive method. \\label{sim_"</span>,<span class="va">mode</span>,<span class="st">"}"</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">info</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">info</span><span class="op">)</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="va">x</span>,<span class="st">"Ka"</span><span class="op">=</span><span class="st">"$K_a$"</span>,<span class="st">"K"</span><span class="op">=</span><span class="st">"$K$"</span>,<span class="st">"h"</span><span class="op">=</span><span class="st">"$h$"</span>,<span class="st">"alpha"</span><span class="op">=</span><span class="st">"$\\alpha$"</span>,<span class="st">"rho.x"</span><span class="op">=</span><span class="st">"$\\rho_x$"</span>,<span class="st">"rho.beta"</span><span class="op">=</span><span class="st">"$\\rho_\\beta$"</span>,<span class="st">"cor.x"</span><span class="op">=</span><span class="st">"$\\bar{\\rho}_{x}$"</span>,<span class="st">"cor.beta"</span><span class="op">=</span><span class="st">"$\\max(\\hat{\\rho}_{\\beta})$"</span>,<span class="st">"cor.t"</span><span class="op">=</span><span class="st">"$\\bar{\\rho}_{a}$"</span>,<span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">both</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"\\texttt{"</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">both</span><span class="op">)</span>,<span class="st">"}"</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">align</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"|r|"</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"c"</span>,times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">info</span><span class="op">)</span><span class="op">)</span>,collapse<span class="op">=</span><span class="st">""</span><span class="op">)</span>,<span class="st">"|"</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"c"</span>,times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">both</span><span class="op">)</span><span class="op">)</span>,collapse<span class="op">=</span><span class="st">""</span><span class="op">)</span>,<span class="st">"|"</span><span class="op">)</span></span>
<span>    <span class="va">xtable</span> <span class="op">&lt;-</span> <span class="fu">xtable</span><span class="fu">::</span><span class="fu">xtable</span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">info</span>,<span class="va">both</span><span class="op">)</span>,align<span class="op">=</span><span class="va">align</span>,caption<span class="op">=</span><span class="va">caption</span><span class="op">)</span></span>
<span>    <span class="fu">xtable</span><span class="fu">::</span><span class="fu">print.xtable</span><span class="op">(</span>x<span class="op">=</span><span class="va">xtable</span>,</span>
<span>                include.rownames<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                floating<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                sanitize.text.function<span class="op">=</span><span class="va">identity</span>,</span>
<span>                comment<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                caption.placement<span class="op">=</span><span class="st">"top"</span>,</span>
<span>                size<span class="op">=</span><span class="st">"\\small \\setlength{\\tabcolsep}{3pt}"</span>,</span>
<span>                file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/manuscript/table_"</span>,<span class="va">mode</span>,<span class="st">".tex"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="external-applications">External applications<a class="anchor" aria-label="anchor" href="#external-applications"></a>
</h2>
<p>The following chunk performs the first external application
(<code>GRridge</code>).</p>
<ul>
<li><p>input: none (<em>script loads data - which are also available <a href="https://github.com/markvdwiel/GRridge/blob/master/data/dataVerlaat.rda" class="external-link">here</a>
- from the R package <a href="https://doi.org/10.18129/B9.bioc.GRridge" class="external-link"><code>GRridge</code></a></em>)</p></li>
<li><p>execution time: <strong>1.5 hours</strong></p></li>
<li><p>output: results/app_grridge.RData,
results/info_app_grridge.txt</p></li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#&lt;&lt;init&gt;&gt;</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dataVerlaat</span>,package<span class="op">=</span><span class="st">"GRridge"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">target</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">target</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">respVerlaat</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span></span>
<span><span class="va">target</span><span class="op">$</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">datcenVerlaat</span><span class="op">)</span></span>
<span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">pvalFarkas</span><span class="op">)</span> <span class="co"># ecpc and fwelnet</span></span>
<span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></span><span class="op">(</span><span class="va">diffmeanFarkas</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">pvalFarkas</span><span class="op">)</span><span class="op">)</span> <span class="co"># transreg</span></span>
<span></span>
<span><span class="va">loss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"---"</span>,<span class="va">i</span>,<span class="st">"---\n"</span><span class="op">)</span></span>
<span>  <span class="va">loss</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">transreg</span><span class="fu">:::</span><span class="fu"><a href="../reference/compare.html">compare</a></span><span class="op">(</span>target<span class="op">=</span><span class="va">target</span>,prior<span class="op">=</span><span class="va">prior</span>,z<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">z</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>                                    family<span class="op">=</span><span class="st">"binomial"</span>,alpha<span class="op">=</span><span class="fl">0</span>,scale<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exp"</span>,<span class="st">"iso"</span><span class="op">)</span>,sign<span class="op">=</span><span class="cn">FALSE</span>,switch<span class="op">=</span><span class="cn">FALSE</span>,select<span class="op">=</span><span class="cn">FALSE</span>,type.measure<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deviance"</span>,<span class="st">"class"</span>,<span class="st">"auc"</span><span class="op">)</span>,seed<span class="op">=</span><span class="va">i</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">loss</span>,file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/results/app_grridge.RData"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span>text<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/utils/capture.output.html" class="external-link">capture.output</a></span><span class="op">(</span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n"</span><span class="op">)</span>,</span>
<span>      <span class="fu">sessioninfo</span><span class="fu">::</span><span class="fu"><a href="https://r-lib.github.io/sessioninfo/reference/session_info.html" class="external-link">session_info</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,con<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/results/info_app_grridge.txt"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/results/app_grridge.RData"</span><span class="op">)</span>,verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">loss</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">deviance</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">table</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">table</span><span class="op">-</span><span class="va">table</span><span class="op">$</span><span class="va">glmnet</span><span class="op">)</span><span class="op">/</span><span class="va">table</span><span class="op">$</span><span class="va">glmnet</span></span>
<span><span class="va">table</span> <span class="op">&lt;-</span> <span class="va">table</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"glmnet"</span>,<span class="st">"transreg.exp.sta"</span>,<span class="st">"transreg.exp.sim"</span>,<span class="st">"transreg.iso.sta"</span>,<span class="st">"transreg.iso.sim"</span>,<span class="st">"fwelnet"</span>,<span class="st">"ecpc"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">table</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">&lt;</span><span class="va">table</span><span class="op">$</span><span class="va">glmnet</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">table</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>The following chunk performs the second external application
(<code>fwelnet</code>).</p>
<ul>
<li><p>input: data/pone.0181468.s001.csv (<em>available from <a href="https://doi.org/10.1371/journal.pone.0181468" class="external-link">Erez et al. 2017</a>
in the supporting file <a href="https://doi.org/10.1371/journal.pone.0181468.s001" class="external-link">journal.pone.0181468.s001.csv</a></em>)</p></li>
<li><p>execution time: <strong>20 minutes</strong></p></li>
<li><p>output: results/app_fwelnet.RData,
results/info_app_fwelnet.txt</p></li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#&lt;&lt;init&gt;&gt;</span></span>
<span></span>
<span><span class="va">table</span> <span class="op">&lt;-</span> <span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"data/pone.0181468.s001.csv"</span>,header<span class="op">=</span><span class="cn">TRUE</span>,skip<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">extract</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">cond</span>,<span class="va">y</span>,<span class="va">X</span>,<span class="va">id</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cond</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">!=</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span><span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Invalid input."</span><span class="op">)</span><span class="op">}</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">id</span>,<span class="va">cond</span><span class="op">)</span><span class="op">[</span>,<span class="st">"TRUE"</span><span class="op">]</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[</span><span class="va">cond</span><span class="op">]</span></span>
<span>  <span class="va">X</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span><span class="va">cond</span>,<span class="op">]</span></span>
<span>  <span class="va">id</span> <span class="op">&lt;-</span> <span class="va">id</span><span class="op">[</span><span class="va">cond</span><span class="op">]</span></span>
<span>  <span class="va">weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">n</span>,times<span class="op">=</span><span class="va">n</span><span class="op">)</span></span>
<span>  <span class="va">ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span>  <span class="va">ys</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">ids</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">y</span><span class="op">[</span><span class="va">id</span><span class="op">==</span><span class="va">x</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">foldid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>,length<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ids</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">foldid</span><span class="op">[</span><span class="va">ys</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,length.out<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">ys</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">foldid</span><span class="op">[</span><span class="va">ys</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,length.out<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">ys</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">foldid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">foldid</span>,times<span class="op">=</span><span class="va">n</span><span class="op">[</span><span class="va">n</span><span class="op">!=</span><span class="fl">0</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">weights</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">foldid</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">!=</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Invalid output."</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">y</span>,x<span class="op">=</span><span class="va">X</span>,weights<span class="op">=</span><span class="va">weights</span>,foldid<span class="op">=</span><span class="va">foldid</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">loss</span> <span class="op">&lt;-</span> <span class="va">ridge</span> <span class="op">&lt;-</span> <span class="va">lasso</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"---"</span>,<span class="va">i</span>,<span class="st">"---\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">table</span><span class="op">$</span><span class="va">LatePE</span></span>
<span>  <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">table</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span>pattern<span class="op">=</span><span class="st">"SL"</span>,x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">table</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">table</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span>,<span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">table</span><span class="op">$</span><span class="va">GA</span><span class="op">[</span><span class="va">table</span><span class="op">$</span><span class="va">ID</span><span class="op">==</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">max</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">table</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span>,<span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">table</span><span class="op">$</span><span class="va">GA</span><span class="op">[</span><span class="va">table</span><span class="op">$</span><span class="va">ID</span><span class="op">==</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">limit</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span>  <span class="va">group</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">table</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span>,size<span class="op">=</span><span class="fl">1</span>,prob<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="va">source.id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">group</span><span class="op">==</span><span class="fl">0</span> <span class="op">|</span> <span class="va">min</span> <span class="op">&gt;</span> <span class="va">limit</span><span class="op">)</span></span>
<span>  <span class="va">target.id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">group</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">min</span> <span class="op">&lt;=</span> <span class="va">limit</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="op">!</span><span class="va">table</span><span class="op">$</span><span class="va">ID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">source.id</span>,<span class="va">target.id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="op">)</span><span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">source.id</span>,<span class="va">target.id</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">table</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="op">)</span><span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">source.id</span>,<span class="va">target.id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="op">)</span><span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">source</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">source</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract.html">extract</a></span><span class="op">(</span>cond<span class="op">=</span><span class="op">(</span><span class="va">table</span><span class="op">$</span><span class="va">ID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">source.id</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">table</span><span class="op">$</span><span class="va">GA</span><span class="op">&lt;=</span><span class="va">limit</span><span class="op">)</span>,y<span class="op">=</span><span class="va">y</span>,X<span class="op">=</span><span class="va">X</span>,id<span class="op">=</span><span class="va">table</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span></span>
<span>  <span class="va">source</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract.html">extract</a></span><span class="op">(</span>cond<span class="op">=</span><span class="op">(</span><span class="va">table</span><span class="op">$</span><span class="va">ID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">source.id</span><span class="op">)</span>,y<span class="op">=</span><span class="va">y</span>,X<span class="op">=</span><span class="va">X</span>,id<span class="op">=</span><span class="va">table</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">prior</span> <span class="op">&lt;-</span> <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>,nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">source</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">source</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">base</span> <span class="op">&lt;-</span> <span class="fu">glmnet</span><span class="fu">::</span><span class="fu"><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html" class="external-link">cv.glmnet</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">source</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">y</span>,x<span class="op">=</span><span class="va">source</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">x</span>,</span>
<span>                              family<span class="op">=</span><span class="st">"binomial"</span>,alpha<span class="op">=</span><span class="fl">0</span>,</span>
<span>                              weights<span class="op">=</span><span class="va">source</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">weights</span>,</span>
<span>                              foldid<span class="op">=</span><span class="va">source</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">foldid</span><span class="op">)</span></span>
<span>    <span class="va">prior</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">base</span>,s<span class="op">=</span><span class="st">"lambda.min"</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="va">z</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">base</span>,s<span class="op">=</span><span class="st">"lambda.min"</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">target</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">target</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">target.id</span>,<span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">y</span><span class="op">[</span><span class="va">table</span><span class="op">$</span><span class="va">ID</span><span class="op">==</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">target</span><span class="op">$</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">target.id</span>,<span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="va">X</span><span class="op">[</span><span class="va">table</span><span class="op">$</span><span class="va">ID</span><span class="op">==</span><span class="va">i</span> <span class="op">&amp;</span> <span class="va">table</span><span class="op">$</span><span class="va">GA</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">table</span><span class="op">$</span><span class="va">GA</span><span class="op">[</span><span class="va">table</span><span class="op">$</span><span class="va">ID</span><span class="op">==</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">loss</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">transreg</span><span class="fu">:::</span><span class="fu"><a href="../reference/compare.html">compare</a></span><span class="op">(</span>target<span class="op">=</span><span class="va">target</span>,prior<span class="op">=</span><span class="va">prior</span>,family<span class="op">=</span><span class="st">"binomial"</span>,alpha<span class="op">=</span><span class="fl">0</span>,scale<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exp"</span>,<span class="st">"iso"</span><span class="op">)</span>,sign<span class="op">=</span><span class="cn">FALSE</span>,switch<span class="op">=</span><span class="cn">FALSE</span>,select<span class="op">=</span><span class="cn">FALSE</span>,z<span class="op">=</span><span class="va">z</span>,type.measure<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deviance"</span>,<span class="st">"class"</span>,<span class="st">"auc"</span><span class="op">)</span>,seed<span class="op">=</span><span class="va">i</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">loss</span>,file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/results/app_fwelnet.RData"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span>text<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/utils/capture.output.html" class="external-link">capture.output</a></span><span class="op">(</span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n"</span><span class="op">)</span>,</span>
<span>      <span class="fu">sessioninfo</span><span class="fu">::</span><span class="fu"><a href="https://r-lib.github.io/sessioninfo/reference/session_info.html" class="external-link">session_info</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,con<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/results/info_app_fwelnet.txt"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/results/app_fwelnet.RData"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">loss</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">deviance</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">table</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">table</span><span class="op">-</span><span class="va">table</span><span class="op">$</span><span class="va">glmnet</span><span class="op">)</span><span class="op">/</span><span class="va">table</span><span class="op">$</span><span class="va">glmnet</span></span>
<span><span class="va">table</span> <span class="op">&lt;-</span> <span class="va">table</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"glmnet"</span>,<span class="st">"transreg.exp.sta"</span>,<span class="st">"transreg.exp.sim"</span>,<span class="st">"transreg.iso.sta"</span>,<span class="st">"transreg.iso.sim"</span>,<span class="st">"fwelnet"</span>,<span class="st">"ecpc"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">table</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">&lt;</span><span class="va">table</span><span class="op">$</span><span class="va">glmnet</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">table</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>The following chunk generates the figure for both external
applications (<code>GRridge</code> and <code>fwelnet</code>).
<strong>Requires execution of previous two chunks.</strong></p>
<ul>
<li><p>input: results/app_grridge.RData,
results/app_fwelnet.RData</p></li>
<li><p>execution time: some seconds</p></li>
<li><p>output: manuscript/figure_ext.pdf</p></li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html" class="external-link">pdf</a></span><span class="op">(</span>file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/manuscript/figure_ext.pdf"</span><span class="op">)</span>,width<span class="op">=</span><span class="fl">8</span>,height<span class="op">=</span><span class="fl">6</span>,pointsize<span class="op">=</span><span class="fl">15</span><span class="op">)</span></span>
<span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>,mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>,<span class="fl">3.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grridge"</span>,<span class="st">"fwelnet"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/results/app_"</span>,<span class="va">k</span>,<span class="st">".RData"</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/graphics/frame.html" class="external-link">plot.new</a></span><span class="op">(</span><span class="op">)</span>;<span class="kw">next</span><span class="op">}</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span></span>
<span>  <span class="va">loss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">loss</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">deviance</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span>pattern<span class="op">=</span><span class="st">"transreg."</span>,replacement<span class="op">=</span><span class="st">""</span>,x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">loss</span> <span class="op">&lt;-</span> <span class="fl">100</span><span class="op">*</span><span class="op">(</span><span class="va">loss</span><span class="op">-</span><span class="va">loss</span><span class="op">$</span><span class="va">glmnet</span><span class="op">)</span><span class="op">/</span><span class="va">loss</span><span class="op">$</span><span class="va">glmnet</span></span>
<span></span>
<span>  <span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exp.sta"</span>,<span class="st">"exp.sim"</span>,<span class="st">"iso.sta"</span>,<span class="st">"iso.sim"</span><span class="op">)</span></span>
<span>  <span class="va">name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fwelnet"</span>,<span class="st">"ecpc"</span>,<span class="va">temp</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/frame.html" class="external-link">plot.new</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html" class="external-link">plot.window</a></span><span class="op">(</span>xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span><span class="op">+</span><span class="fl">0.5</span><span class="op">)</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">loss</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span>,lty<span class="op">=</span><span class="fl">2</span>,col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span>side<span class="op">=</span><span class="fl">1</span>,at<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span>,labels<span class="op">=</span><span class="va">name</span>,cex.axis<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span>pattern<span class="op">=</span><span class="st">"grridge"</span>,x<span class="op">=</span><span class="va">k</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="va">at</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="op">-</span><span class="fl">10</span>,to<span class="op">=</span><span class="fl">10</span>,by<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span>pattern<span class="op">=</span><span class="st">"fwelnet"</span>,x<span class="op">=</span><span class="va">k</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="va">at</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="op">-</span><span class="fl">20</span>,to<span class="op">=</span><span class="fl">20</span>,by<span class="op">=</span><span class="fl">10</span><span class="op">)</span><span class="op">}</span></span>
<span>  <span class="va">labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">at</span><span class="op">==</span><span class="fl">0</span>,<span class="st">"0%"</span>,<span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">at</span><span class="op">&lt;</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">at</span>,<span class="st">"%"</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"+"</span>,<span class="va">at</span>,<span class="st">"%"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span>side<span class="op">=</span><span class="fl">2</span>,cex.axis<span class="op">=</span><span class="fl">0.7</span>,at<span class="op">=</span><span class="va">at</span>,labels<span class="op">=</span><span class="va">labels</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span>ylab<span class="op">=</span><span class="st">"change in loss"</span>,line<span class="op">=</span><span class="fl">2.5</span>,cex.lab<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu">palasso</span><span class="fu">:::</span><span class="fu">.boxplot</span><span class="op">(</span><span class="va">loss</span><span class="op">[</span>,<span class="va">name</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,at<span class="op">=</span><span class="va">i</span>,invert<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">i</span>,y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">loss</span><span class="op">[</span>,<span class="va">name</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,pch<span class="op">=</span><span class="fl">22</span>,col<span class="op">=</span><span class="st">"white"</span>,bg<span class="op">=</span><span class="st">"black"</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="internal-application">Internal application<a class="anchor" aria-label="anchor" href="#internal-application"></a>
</h2>
<p>The following chunk performs the internal application.</p>
<ul>
<li><p>input: data/vcf_with_pvalue.tab, data/LuxPark_pheno.txt
(<em>available upon request to <a href="mailto:request.ncer-pd@uni.lu?cc=armin.rauschenberger@uni.lu,enrico.glaab@uni.lu&amp;subject=data%20request%20Rauschenberger%20et%20al.%20(%22transreg%22)">request.ncer-pd@uni.lu</a></em>)</p></li>
<li><p>execution time: <strong>5.5 hours</strong> (parallel computing
with 8 cores)</p></li>
<li><p>output: data/app_int_data.RData, results/app_int.RData,
results/info_app_int.txt</p></li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#&lt;&lt;init&gt;&gt;</span></span>
<span><span class="va">geno</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/data/vcf_with_pvalue.tab"</span><span class="op">)</span>,header<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">switch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">geno</span><span class="op">$</span><span class="va">REF</span><span class="op">==</span><span class="va">geno</span><span class="op">$</span><span class="va">A1_gwas</span> <span class="op">&amp;</span> <span class="va">geno</span><span class="op">$</span><span class="va">ALT</span><span class="op">==</span><span class="va">geno</span><span class="op">$</span><span class="va">A2_gwas</span>,<span class="fl">1</span>,</span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">geno</span><span class="op">$</span><span class="va">REF</span><span class="op">==</span><span class="va">geno</span><span class="op">$</span><span class="va">A2_gwas</span> <span class="op">&amp;</span> <span class="va">geno</span><span class="op">$</span><span class="va">ALT</span><span class="op">==</span><span class="va">geno</span><span class="op">$</span><span class="va">A1_gwas</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#prior &lt;- -geno$beta*switch # original effect sizes</span></span>
<span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">geno</span><span class="op">$</span><span class="va">p_value</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></span><span class="op">(</span><span class="va">geno</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span><span class="op">*</span><span class="va">switch</span> <span class="co"># pseudo effect sizes</span></span>
<span><span class="va">pvalue</span> <span class="op">&lt;-</span> <span class="va">geno</span><span class="op">$</span><span class="va">p_value</span></span>
<span></span>
<span><span class="co"># Note: Why are pseudo-effect sizes more suitable as prior effects as compared to original effect sizes?</span></span>
<span><span class="co"># graphics::plot(x=geno$beta,y=-log10(geno$p_value),xlim=c(-1,1),col=ifelse(stats::p.adjust(geno$p_value)&lt;=0.05,"red","black"))</span></span>
<span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">geno</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span>pattern<span class="op">=</span><span class="st">"ND"</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">geno</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">X</span><span class="op">[</span><span class="va">X</span><span class="op">==</span><span class="st">"0/0"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">X</span><span class="op">[</span><span class="va">X</span><span class="op">==</span><span class="st">"0/1"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">X</span><span class="op">[</span><span class="va">X</span><span class="op">==</span><span class="st">"1/1"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">as.numeric</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pheno</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.delim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/data/LuxPark_pheno.txt"</span><span class="op">)</span>,sep<span class="op">=</span><span class="st">" "</span>,header<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">pheno</span><span class="op">$</span><span class="va">V2</span><span class="op">==</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">pheno</span><span class="op">$</span><span class="va">V2</span><span class="op">==</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="cn">NA</span><span class="op">)</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">pheno</span><span class="op">$</span><span class="va">V1</span></span>
<span></span>
<span><span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">y</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span><span class="va">names</span>,<span class="op">]</span>; <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[</span><span class="va">names</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Note: Are prior effects positively correlated with correlation between outcome and features?</span></span>
<span><span class="co"># cor &lt;- as.numeric(stats::cor(y,X,method="spearman"))</span></span>
<span><span class="co"># graphics::plot(x=prior,y=cor,col=ifelse(stats::p.adjust(geno$p_value)&lt;=0.05,"red","black"))</span></span>
<span><span class="co"># graphics::abline(h=0,lty=2,col="grey")</span></span>
<span></span>
<span><span class="co"># descriptive statistics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></span><span class="op">(</span><span class="va">pvalue</span>,method<span class="op">=</span><span class="st">"BH"</span><span class="op">)</span><span class="op">&lt;=</span><span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></span><span class="op">(</span><span class="va">pvalue</span>,method<span class="op">=</span><span class="st">"holm"</span><span class="op">)</span><span class="op">&lt;=</span><span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">pvalue</span><span class="op">&lt;=</span><span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># memory reduction</span></span>
<span><span class="va">cond</span> <span class="op">&lt;-</span> <span class="va">pvalue</span> <span class="op">&lt;=</span> <span class="fl">0.05</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span>,<span class="va">cond</span><span class="op">]</span></span>
<span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="va">prior</span><span class="op">[</span><span class="va">cond</span><span class="op">]</span></span>
<span><span class="va">pvalue</span> <span class="op">&lt;-</span> <span class="va">pvalue</span><span class="op">[</span><span class="va">cond</span><span class="op">]</span></span>
<span><span class="va">switch</span> <span class="op">&lt;-</span> <span class="va">switch</span><span class="op">[</span><span class="va">cond</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">y</span>,<span class="va">X</span>,<span class="va">prior</span>,<span class="va">pvalue</span>,<span class="va">switch</span>,file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/data/app_int_data.RData"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/data/app_int_data.RData"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">power</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="op">-</span><span class="fl">2</span>,to<span class="op">=</span><span class="op">-</span><span class="fl">10</span>,by<span class="op">=</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">cutoff</span> <span class="op">&lt;-</span> <span class="fl">5</span><span class="op">*</span><span class="fl">10</span><span class="op">^</span><span class="va">power</span></span>
<span><span class="va">frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>cutoff<span class="op">=</span><span class="va">cutoff</span>,alpha<span class="op">=</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>,seed<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,count<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#- - - sequential (start) - - -</span></span>
<span><span class="co">#loss &lt;- list()</span></span>
<span><span class="co">#for(i in seq_len(nrow(frame))){</span></span>
<span><span class="co">#  cat("--- i =",i,"---","\n")</span></span>
<span><span class="co">#  set.seed(frame$seed[i])</span></span>
<span><span class="co">#  foldid &lt;- transreg:::.folds(y=y,nfolds.ext=10,nfolds.int=10)</span></span>
<span><span class="co">#  cond &lt;- switch!=0 &amp; pvalue &lt; frame$cutoff[i]</span></span>
<span><span class="co">#  loss[[i]] &lt;- transreg:::compare(target=list(y=y,x=X[,cond]),prior=prior[cond],family="binomial",alpha=frame$alpha[i],scale=c("exp","iso"),sign=FALSE,switch=FALSE,select=FALSE,foldid.ext=foldid$foldid.ext,foldid.int=foldid$foldid.int,type.measure=c("deviance","class","auc"),seed=frame$seed[i])</span></span>
<span><span class="co">#  frame$count[i] &lt;- sum(cond)</span></span>
<span><span class="co">#}</span></span>
<span><span class="co"># - - - sequential (end) - - -</span></span>
<span></span>
<span><span class="co">#- - - parallel (start) - - -</span></span>
<span><span class="va">frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>cutoff<span class="op">=</span><span class="va">cutoff</span>,alpha<span class="op">=</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>,seed<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,count<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span>
<span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="fu">snow</span><span class="fu">::</span><span class="fu">makeCluster</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span></span>
<span><span class="va">evaluate</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">frame</span>,<span class="va">i</span>,<span class="va">switch</span>,<span class="va">pvalue</span>,<span class="va">y</span>,<span class="va">X</span>,<span class="va">prior</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">frame</span><span class="op">$</span><span class="va">seed</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">foldid</span> <span class="op">&lt;-</span> <span class="fu">transreg</span><span class="fu">:::</span><span class="fu">.folds</span><span class="op">(</span>y<span class="op">=</span><span class="va">y</span>,nfolds.ext<span class="op">=</span><span class="fl">10</span>,nfolds.int<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="va">cond</span> <span class="op">&lt;-</span> <span class="va">switch</span><span class="op">!=</span><span class="fl">0</span> <span class="op">&amp;</span> <span class="va">pvalue</span> <span class="op">&lt;</span> <span class="va">frame</span><span class="op">$</span><span class="va">cutoff</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="fu">transreg</span><span class="fu">:::</span><span class="fu"><a href="../reference/compare.html">compare</a></span><span class="op">(</span>target<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">y</span>,x<span class="op">=</span><span class="va">X</span><span class="op">[</span>,<span class="va">cond</span><span class="op">]</span><span class="op">)</span>,prior<span class="op">=</span><span class="va">prior</span><span class="op">[</span><span class="va">cond</span><span class="op">]</span>,family<span class="op">=</span><span class="st">"binomial"</span>,alpha<span class="op">=</span><span class="va">frame</span><span class="op">$</span><span class="va">alpha</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,scale<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exp"</span>,<span class="st">"iso"</span><span class="op">)</span>,sign<span class="op">=</span><span class="cn">FALSE</span>,switch<span class="op">=</span><span class="cn">FALSE</span>,select<span class="op">=</span><span class="cn">FALSE</span>,foldid.ext<span class="op">=</span><span class="va">foldid</span><span class="op">$</span><span class="va">foldid.ext</span>,foldid.int<span class="op">=</span><span class="va">foldid</span><span class="op">$</span><span class="va">foldid.int</span>,type.measure<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deviance"</span>,<span class="st">"class"</span>,<span class="st">"auc"</span><span class="op">)</span>,seed<span class="op">=</span><span class="va">frame</span><span class="op">$</span><span class="va">seed</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">snow</span><span class="fu">::</span><span class="fu">clusterExport</span><span class="op">(</span>cl<span class="op">=</span><span class="va">cluster</span>,list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"evaluate"</span>,<span class="st">"frame"</span>,<span class="st">"switch"</span>,<span class="st">"pvalue"</span>,<span class="st">"y"</span>,<span class="st">"X"</span>,<span class="st">"prior"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">loss</span> <span class="op">&lt;-</span> <span class="fu">snow</span><span class="fu">::</span><span class="fu">parSapply</span><span class="op">(</span>cl<span class="op">=</span><span class="va">cluster</span>,X<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">frame</span><span class="op">)</span><span class="op">)</span>,FUN<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu">evaluate</span><span class="op">(</span>frame<span class="op">=</span><span class="va">frame</span>,i<span class="op">=</span><span class="va">i</span>,switch<span class="op">=</span><span class="va">switch</span>,pvalue<span class="op">=</span><span class="va">pvalue</span>,y<span class="op">=</span><span class="va">y</span>,X<span class="op">=</span><span class="va">X</span>,prior<span class="op">=</span><span class="va">prior</span><span class="op">)</span>,simplify<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#- - - parallel (end) - - -</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">frame</span>,<span class="va">loss</span>,file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/results/app_int.RData"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span>text<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/utils/capture.output.html" class="external-link">capture.output</a></span><span class="op">(</span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n"</span><span class="op">)</span>,</span>
<span>      <span class="fu">sessioninfo</span><span class="fu">::</span><span class="fu"><a href="https://r-lib.github.io/sessioninfo/reference/session_info.html" class="external-link">session_info</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,con<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/results/info_app_int.txt"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The following chunk generates the figures for the internal
application. <strong>Requires execution of previous chunk.</strong></p>
<ul>
<li><p>input: results/app_int.RData</p></li>
<li><p>execution time: some seconds</p></li>
<li><p>output: manuscript/figure_int.pdf,
manuscript/figure_temp.pdf</p></li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#&lt;&lt;init&gt;&gt;</span></span>
<span></span>
<span><span class="va">plotter</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">table</span>,<span class="va">cutoff</span>,<span class="va">number</span>,<span class="va">horizontal</span><span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1.8</span>,<span class="fl">1.0</span>,<span class="fl">0.9</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">scale</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exp"</span>,<span class="st">"iso"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw">for</span><span class="op">(</span><span class="va">alpha</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span>,<span class="st">"1"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/frame.html" class="external-link">plot.new</a></span><span class="op">(</span><span class="op">)</span></span>
<span>      <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html" class="external-link">plot.window</a></span><span class="op">(</span>xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">cutoff</span><span class="op">)</span><span class="op">)</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">table</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span>
<span>      <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span>main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">==</span><span class="fl">0</span>,<span class="st">"ridge"</span>,<span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">==</span><span class="fl">1</span>,<span class="st">"lasso"</span>,<span class="cn">NA</span><span class="op">)</span><span class="op">)</span>,<span class="st">"-"</span>,<span class="va">scale</span><span class="op">)</span>,cex.main<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span></span>
<span>      <span class="va">on</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>,<span class="cn">FALSE</span><span class="op">)</span>,length.out<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cutoff</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span>side<span class="op">=</span><span class="fl">1</span>,at<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">cutoff</span><span class="op">)</span>,labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">""</span>,times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">on</span><span class="op">)</span><span class="op">)</span>,cex.axis<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span>      <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span>side<span class="op">=</span><span class="fl">1</span>,at<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">cutoff</span><span class="op">)</span><span class="op">[</span><span class="va">on</span><span class="op">]</span>,labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">cutoff</span><span class="op">[</span><span class="va">on</span><span class="op">]</span>,<span class="st">"\n"</span>,<span class="st">"("</span>,<span class="va">number</span><span class="op">[</span><span class="va">on</span><span class="op">]</span>,<span class="st">")"</span><span class="op">)</span>,cex.axis<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span>      <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span>side<span class="op">=</span><span class="fl">2</span>,cex.axis<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="va">horizontal</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0.5</span>,col<span class="op">=</span><span class="st">"grey"</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span>        <span class="co">#graphics::abline(h=unique(table[["mean"]][,alpha]),col="grey",lty=2)</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="kw">for</span><span class="op">(</span><span class="va">method</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"glmnet"</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"transreg."</span>,<span class="va">scale</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">".sta"</span>,<span class="st">".sim"</span><span class="op">)</span><span class="op">)</span>,<span class="st">"naive"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>          <span class="va">lty</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="va">method</span>,<span class="st">"mean"</span><span class="op">=</span><span class="fl">1</span>,<span class="st">"glmnet"</span><span class="op">=</span><span class="fl">1</span>,<span class="st">"transreg.exp.sta"</span><span class="op">=</span><span class="fl">2</span>,<span class="st">"transreg.exp.sim"</span><span class="op">=</span><span class="fl">2</span>,<span class="st">"transreg.iso.sta"</span><span class="op">=</span><span class="fl">2</span>,<span class="st">"transreg.iso.sim"</span><span class="op">=</span><span class="fl">2</span>,<span class="st">"naive"</span><span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span>          <span class="va">col</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="va">method</span>,<span class="st">"mean"</span><span class="op">=</span><span class="st">"grey"</span>,<span class="st">"glmnet"</span><span class="op">=</span><span class="st">"black"</span>,<span class="st">"transreg.exp.sta"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">1</span><span class="op">)</span>,<span class="st">"transreg.iso.sta"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">1</span><span class="op">)</span>,<span class="st">"transreg.exp.sim"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0.6</span><span class="op">)</span>,<span class="st">"transreg.iso.sim"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0.6</span><span class="op">)</span>,<span class="st">"naive"</span><span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span>          <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">table</span><span class="op">[[</span><span class="va">method</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="va">alpha</span><span class="op">]</span></span>
<span>          <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>          <span class="kw">if</span><span class="op">(</span><span class="va">i</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>,y<span class="op">=</span><span class="va">y</span>,col<span class="op">=</span><span class="va">col</span>,lty<span class="op">=</span><span class="va">lty</span><span class="op">)</span><span class="op">}</span></span>
<span>          <span class="kw">if</span><span class="op">(</span><span class="va">i</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span><span class="op">{</span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>,y<span class="op">=</span><span class="va">y</span>,col<span class="op">=</span><span class="st">"white"</span>,pch<span class="op">=</span><span class="fl">16</span><span class="op">)</span><span class="op">}</span></span>
<span>          <span class="kw">if</span><span class="op">(</span><span class="va">i</span><span class="op">==</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>,y<span class="op">=</span><span class="va">y</span>,col<span class="op">=</span><span class="va">col</span><span class="op">)</span><span class="op">}</span></span>
<span>        <span class="op">}</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/data/app_int_data.RData"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/results/app_int.RData"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">frame</span> <span class="op">&lt;-</span> <span class="va">frame</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">frame</span><span class="op">)</span><span class="op">!=</span><span class="st">"seed"</span><span class="op">]</span></span>
<span><span class="va">cutoff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">frame</span><span class="op">$</span><span class="va">cutoff</span><span class="op">)</span></span>
<span><span class="va">number</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">loss</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">loss</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">auc</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">auc</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span>X<span class="op">=</span><span class="va">x</span>,INDEX<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">frame</span><span class="op">$</span><span class="va">cutoff</span>,<span class="va">frame</span><span class="op">$</span><span class="va">alpha</span><span class="op">)</span>,FUN<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html" class="external-link">pdf</a></span><span class="op">(</span>file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/manuscript/figure_int.pdf"</span><span class="op">)</span>,width<span class="op">=</span><span class="fl">8</span>,height<span class="op">=</span><span class="fl">6</span>,pointsize<span class="op">=</span><span class="fl">15</span><span class="op">)</span></span>
<span><span class="fu">plotter</span><span class="op">(</span><span class="va">table</span>,<span class="va">cutoff</span>,<span class="va">number</span>,horizontal<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a>
</h2>
<p>Reformat list of consortium members for acknowledgements: [see
source].</p>
</div>
<div class="section level2">
<h2 id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<p>Print session information.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Armin Rauschenberger.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
